@model DraperyOrderFormModel
@using Nop.Web.Models.Common;
@{
    Layout = "~/Views/Shared/_ColumnsTwo.cshtml";

    //title
    Html.AddTitleParts("Ripple Fold Order Form");
    Html.AddScriptParts("https://code.jquery.com/ui/1.12.1/jquery-ui.js");
    Html.AddScriptParts("https://cdn.jsdelivr.net/npm/mathjs@8.0.1/lib/browser/math.min.js");
    Html.AddCssFileParts("//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css");
}
@using (Html.BeginForm())
{
    <div class="custom-page-box-border-less-div">
        <div class="breadcrumbs">
            <ol class="breadcrumb">

                <li><a href="@Url.RouteUrl("HomePage")" title="@T("Categories.Breadcrumb.Top")">@T("Categories.Breadcrumb.Top")</a></li>
                <li class="active">Ripple Fold Order Form</li>

            </ol>
        </div>
    </div>
    <div>
        <h3 class="pull-left">
            RIPPLE FOLD ORDER FORM
        </h3>
        @*<a class="btn btn-primary pull-right" href="RIPPLE FOLD ORDER FORM.xlsx" target="_blank">Download Form (XLSX)</a>*@
    </div>
    <div class="custom-page-box-div" style="clear:both">
        @Html.AntiForgeryToken()
        <div class="text-danger">
            @ViewBag.Message
            @Html.ValidationSummary(true)
        </div>
        <div class="product-details">
            <table style="width:100%; border-spacing:5px; border-collapse:separate">
                <tr>
                    <td style="width:15%">Designer*</td>
                    <td>@Html.TextBoxFor(x => x.Designer, new { @class = "col-sm-7" })</td>
                </tr>
                <tr>
                    <td>Side Mark*</td>
                    <td>@Html.TextBoxFor(x => x.SideMark, new { @class = "col-sm-7" })</td>
                </tr>
                <tr>
                    <td>Phone*</td>
                    <td>@Html.TextBoxFor(x => x.Phone, new { @class = "col-sm-7" })</td>
                </tr>
                <tr>
                    <td>Order Date</td>
                    <td>@Html.TextBoxFor(x => x.OrderDate, new { @class = "col-sm-7, datepicker", autocomplete = "off" })</td>
                </tr>
                <tr>
                    <td>Due Date</td>
                    <td>@Html.TextBoxFor(x => x.DueDate, new { @class = "col-sm-7, datepicker", autocomplete = "off" })</td>
                </tr>
                <tr>
                    <td>Note</td>
                    <td>@Html.TextAreaFor(x => x.Note, new { @class = "col-sm-7" })</td>
                </tr>
            </table>
        </div>
    </div>
    <div>
        <h4>
            Order Detail
        </h4>
    </div>
    <div class="custom-page-box-div" style="clear:both">
        <div class="product-details" style="margin-bottom:0">
            <button type="button" class="btn btn-primary" id="btnAddDetail">New Order Detail</button>
            <button type="button" class="btn btn-primary" id="btnReviewDetail">Review</button>
            @Html.HiddenFor(m => m.OrderDetailJsonStr, new { id = "hdOrderDetail" })
            <table style="width:100%" class="table table-bordered" id="tbOrderDetail">
                <thead>
                    <tr>
                        <th>Actions</th>
                        <th>Line</th>
                        <th>Room Location</th>
                        <th>Qty</th>
                        <th>Type</th>
                        <th>Coverred Area</th>
                        <th>Persentage % Fullness</th>
                        <th>Finished Length</th>
                        <th>Return</th>
                    </tr>

                </thead>
                <tbody></tbody>
            </table>
        </div>
    </div>
    <div style="margin-left:170px">
        @Html.HiddenFor(m => m.DisplayCaptcha)
        @if (Model.DisplayCaptcha)
        {
            <div class="captcha-box">
                @Html.Raw(Html.GenerateCaptcha())
            </div>
        }
    </div>
    <div class="text-center"><input type="submit" class="btn btn-primary" value="Download to Print" name="print" /> <input type="submit" class="btn btn-primary" value="Submit" /></div>
}
<div id="dialogOrderDetail">
    <p class="validateTips"></p>
    <table style="width:100%; border-spacing:5px; border-collapse:separate">
        <tr>
            <td>Line:</td>
            <td><label id="lbLine">1</label></td>
        </tr>
        <tr>
            <td>Room Location:</td>
            <td><input type="text" id="txtRoomLocation" class="col-sm-12" /></td>
        </tr>
        <tr>
            <td>Qty*:</td>
            <td><input type="number" id="txtQty" class="col-sm-12" /></td>
        </tr>
        <tr>
            <td>Type:</td>
            <td>
                <select id="ddlType">
                    <option value="Butt-Master Carriers">Butt-Master Carriers</option>
                    <option value="Overlap Master Carriers">Overlap Master Carriers</option>

                </select>
            </td>
        </tr>
        <tr>
            <td>Coverred Area*:</td>
            <td><input type="number" id="txtCoverredArea" class="col-sm-12" /></td>
        </tr>
        <tr>
            <td>Persentage % Fullness*:</td>
            <td>
                <select id="ddlFullness">
                    <option value="120">120 %</option>
                    <option value="100">100 %</option>
                    <option value="80">80 %</option>
                    <option value="60">60 %</option>
                </select>

            </td>
        </tr>
        <tr>
            <td>Fabric Width per Panel*:</td>
            <td><input type="number" id="txtFabricWidth" class="col-sm-12" /></td>
        </tr>
        <tr>
            <td>No. of Width per Panel:</td>
            <td><input type="text" id="txtNoOfWidth" class="col-sm-12" /></td>
        </tr>
        <tr>
            <td>No. of Buttons Required:</td>
            <td><input type="number" id="txtNoOfBottons" class="col-sm-12" /></td>
        </tr>
        <tr>
            <td>Overlap Button Location:</td>
            <td><input type="text" id="txtOverlapButtonLocation" class="col-sm-12" /></td>
        </tr>
        <tr>
            <td>Finished Length*:</td>
            <td><input type="text" id="txtFinishedLength" class="col-sm-12" /></td>
        </tr>
        <tr>
            <td>Return:</td>
            <td><input type="text" id="txtReturn" class="col-sm-12" /></td>
        </tr>
        <tr>
            <td>Fabric Name & Color:</td>
            <td><input type="text" id="txFabricNameColor" class="col-sm-12" /></td>
        </tr>
        <tr>
            <td>Lining Name & Color:</td>
            <td><input type="text" id="txLiningNameColor" class="col-sm-12" /></td>
        </tr>

    </table>

</div>
<div id="dialogReviewOrderDetail" title="Review Order Detail">
    <table style="width:100%" class="table table-bordered" id="tbReviewOrderDetail">
        <thead>
            <tr>
                <th></th>
                <th>Actions</th>
                <th>Line</th>
                <th>Room Locations</th>
                <th>Qty</th>
                <th>Type</th>
                <th>Coverred Area</th>
                <th>Persentage % Fullness</th>
                <th>Fabric Width per Panel</th>
            </tr>

        </thead>
        <tbody></tbody>
    </table>
</div>
<script>
    var orderDetails = [];
    var isAdding = true;
    var dialog,
        dialogReview,
        tips = $(".validateTips"),
        _line = $("#lbLine"),
        _roomLocation = $('#txtRoomLocation'),
        _qty = $('#txtQty'),
        _type = $('#ddlType'),
        _fullness = $('#ddlFullness'),
        _coverredArea = $('#txtCoverredArea'),
        _fabricWidth = $('#txtFabricWidth'),
        _noOfWidth = $('#txtNoOfWidth'),
        _noOfBottons = $('#txtNoOfBottons'),
        _overlapButtonLocation = $('#txtOverlapButtonLocation'),
        _finishedLength = $('#txtFinishedLength'),
        _return = $('#txtReturn'),
        _fabricNameColor = $('#txFabricNameColor'),
        _liningNameColor = $('#txLiningNameColor'),
        allFields = $([]).add(_roomLocation).add(_qty).add(_fabricWidth).add(_return).add(_noOfBottons).add(_fullness).add(_finishedLength).add(_coverredArea).add(_noOfWidth)
        ;
    var overlapRippleFoldChart = [{ "Fullness": 120, "FinishedFabricWidth": 35.5, "MinPC": 11, "MaxPC": 14, "StackBackWidth": 8, "NoOfCarriers": 8 }, { "Fullness": 100, "FinishedFabricWidth": 35.5, "MinPC": 12, "MaxPC": 16, "StackBackWidth": 8, "NoOfCarriers": 8 }, { "Fullness": 80, "FinishedFabricWidth": 35.5, "MinPC": 14, "MaxPC": 17, "StackBackWidth": 8, "NoOfCarriers": 8 }, { "Fullness": 60, "FinishedFabricWidth": 35.5, "MinPC": 14, "MaxPC": 19, "StackBackWidth": 8, "NoOfCarriers": 8 }, { "Fullness": 120, "FinishedFabricWidth": 44, "MinPC": 15, "MaxPC": 18, "StackBackWidth": 9, "NoOfCarriers": 10 }, { "Fullness": 100, "FinishedFabricWidth": 44, "MinPC": 17, "MaxPC": 20, "StackBackWidth": 9, "NoOfCarriers": 10 }, { "Fullness": 80, "FinishedFabricWidth": 44, "MinPC": 18, "MaxPC": 22, "StackBackWidth": 9, "NoOfCarriers": 10 }, { "Fullness": 60, "FinishedFabricWidth": 44, "MinPC": 20, "MaxPC": 24, "StackBackWidth": 9, "NoOfCarriers": 10 }, { "Fullness": 120, "FinishedFabricWidth": 52.5, "MinPC": 19, "MaxPC": 21, "StackBackWidth": 9.75, "NoOfCarriers": 12 }, { "Fullness": 100, "FinishedFabricWidth": 52.5, "MinPC": 21, "MaxPC": 24, "StackBackWidth": 9.75, "NoOfCarriers": 12 }, { "Fullness": 80, "FinishedFabricWidth": 52.5, "MinPC": 23, "MaxPC": 27, "StackBackWidth": 9.75, "NoOfCarriers": 12 }, { "Fullness": 60, "FinishedFabricWidth": 52.5, "MinPC": 25, "MaxPC": 30, "StackBackWidth": 9.75, "NoOfCarriers": 12 }, { "Fullness": 120, "FinishedFabricWidth": 60.5, "MinPC": 26, "MaxPC": 29, "StackBackWidth": 11.5, "NoOfCarriers": 16 }, { "Fullness": 100, "FinishedFabricWidth": 60.5, "MinPC": 29, "MaxPC": 32, "StackBackWidth": 11.5, "NoOfCarriers": 16 }, { "Fullness": 80, "FinishedFabricWidth": 60.5, "MinPC": 33, "MaxPC": 36, "StackBackWidth": 11.5, "NoOfCarriers": 16 }, { "Fullness": 60, "FinishedFabricWidth": 60.5, "MinPC": 36, "MaxPC": 40, "StackBackWidth": 11.5, "NoOfCarriers": 16 }, { "Fullness": 120, "FinishedFabricWidth": 61, "MinPC": 22, "MaxPC": 25, "StackBackWidth": 10.75, "NoOfCarriers": 14 }, { "Fullness": 100, "FinishedFabricWidth": 61, "MinPC": 25, "MaxPC": 28, "StackBackWidth": 10.75, "NoOfCarriers": 14 }, { "Fullness": 80, "FinishedFabricWidth": 61, "MinPC": 28, "MaxPC": 32, "StackBackWidth": 10.75, "NoOfCarriers": 14 }, { "Fullness": 60, "FinishedFabricWidth": 61, "MinPC": 31, "MaxPC": 35, "StackBackWidth": 10.75, "NoOfCarriers": 14 }, { "Fullness": 120, "FinishedFabricWidth": 78, "MinPC": 30, "MaxPC": 33, "StackBackWidth": 12.5, "NoOfCarriers": 18 }, { "Fullness": 100, "FinishedFabricWidth": 78, "MinPC": 33, "MaxPC": 37, "StackBackWidth": 12.5, "NoOfCarriers": 18 }, { "Fullness": 80, "FinishedFabricWidth": 78, "MinPC": 37, "MaxPC": 41, "StackBackWidth": 12.5, "NoOfCarriers": 18 }, { "Fullness": 60, "FinishedFabricWidth": 78, "MinPC": 41, "MaxPC": 45, "StackBackWidth": 12.5, "NoOfCarriers": 18 }, { "Fullness": 120, "FinishedFabricWidth": 86.5, "MinPC": 34, "MaxPC": 36, "StackBackWidth": 13.25, "NoOfCarriers": 20 }, { "Fullness": 100, "FinishedFabricWidth": 86.5, "MinPC": 38, "MaxPC": 41, "StackBackWidth": 13.25, "NoOfCarriers": 20 }, { "Fullness": 80, "FinishedFabricWidth": 86.5, "MinPC": 42, "MaxPC": 46, "StackBackWidth": 13.25, "NoOfCarriers": 20 }, { "Fullness": 60, "FinishedFabricWidth": 86.5, "MinPC": 46, "MaxPC": 51, "StackBackWidth": 13.25, "NoOfCarriers": 20 }, { "Fullness": 120, "FinishedFabricWidth": 95, "MinPC": 37, "MaxPC": 40, "StackBackWidth": 14.25, "NoOfCarriers": 22 }, { "Fullness": 100, "FinishedFabricWidth": 95, "MinPC": 42, "MaxPC": 45, "StackBackWidth": 14.25, "NoOfCarriers": 22 }, { "Fullness": 80, "FinishedFabricWidth": 95, "MinPC": 47, "MaxPC": 51, "StackBackWidth": 14.25, "NoOfCarriers": 22 }, { "Fullness": 60, "FinishedFabricWidth": 95, "MinPC": 52, "MaxPC": 56, "StackBackWidth": 14.25, "NoOfCarriers": 22 }, { "Fullness": 120, "FinishedFabricWidth": 103.5, "MinPC": 41, "MaxPC": 44, "StackBackWidth": 15, "NoOfCarriers": 24 }, { "Fullness": 100, "FinishedFabricWidth": 103.5, "MinPC": 46, "MaxPC": 50, "StackBackWidth": 15, "NoOfCarriers": 24 }, { "Fullness": 80, "FinishedFabricWidth": 103.5, "MinPC": 52, "MaxPC": 55, "StackBackWidth": 15, "NoOfCarriers": 24 }, { "Fullness": 60, "FinishedFabricWidth": 103.5, "MinPC": 57, "MaxPC": 61, "StackBackWidth": 15, "NoOfCarriers": 24 }, { "Fullness": 120, "FinishedFabricWidth": 112, "MinPC": 45, "MaxPC": 48, "StackBackWidth": 16, "NoOfCarriers": 26 }, { "Fullness": 100, "FinishedFabricWidth": 112, "MinPC": 51, "MaxPC": 54, "StackBackWidth": 16, "NoOfCarriers": 26 }, { "Fullness": 80, "FinishedFabricWidth": 112, "MinPC": 56, "MaxPC": 60, "StackBackWidth": 16, "NoOfCarriers": 26 }, { "Fullness": 60, "FinishedFabricWidth": 112, "MinPC": 62, "MaxPC": 66, "StackBackWidth": 16, "NoOfCarriers": 26 }, { "Fullness": 120, "FinishedFabricWidth": 120.5, "MinPC": 49, "MaxPC": 51, "StackBackWidth": 16.75, "NoOfCarriers": 28 }, { "Fullness": 100, "FinishedFabricWidth": 120.5, "MinPC": 55, "MaxPC": 58, "StackBackWidth": 16.75, "NoOfCarriers": 28 }, { "Fullness": 80, "FinishedFabricWidth": 120.5, "MinPC": 61, "MaxPC": 65, "StackBackWidth": 16.75, "NoOfCarriers": 28 }, { "Fullness": 60, "FinishedFabricWidth": 120.5, "MinPC": 67, "MaxPC": 72, "StackBackWidth": 16.75, "NoOfCarriers": 28 }, { "Fullness": 120, "FinishedFabricWidth": 129, "MinPC": 52, "MaxPC": 55, "StackBackWidth": 17.75, "NoOfCarriers": 30 }, { "Fullness": 100, "FinishedFabricWidth": 129, "MinPC": 59, "MaxPC": 62, "StackBackWidth": 17.75, "NoOfCarriers": 30 }, { "Fullness": 80, "FinishedFabricWidth": 129, "MinPC": 66, "MaxPC": 70, "StackBackWidth": 17.75, "NoOfCarriers": 30 }, { "Fullness": 60, "FinishedFabricWidth": 129, "MinPC": 73, "MaxPC": 77, "StackBackWidth": 17.75, "NoOfCarriers": 30 }, { "Fullness": 120, "FinishedFabricWidth": 137.5, "MinPC": 56, "MaxPC": 59, "StackBackWidth": 18.5, "NoOfCarriers": 32 }, { "Fullness": 100, "FinishedFabricWidth": 137.5, "MinPC": 63, "MaxPC": 66, "StackBackWidth": 18.5, "NoOfCarriers": 32 }, { "Fullness": 80, "FinishedFabricWidth": 137.5, "MinPC": 71, "MaxPC": 74, "StackBackWidth": 18.5, "NoOfCarriers": 32 }, { "Fullness": 60, "FinishedFabricWidth": 137.5, "MinPC": 78, "MaxPC": 82, "StackBackWidth": 18.5, "NoOfCarriers": 32 }, { "Fullness": 120, "FinishedFabricWidth": 146, "MinPC": 60, "MaxPC": 63, "StackBackWidth": 19.5, "NoOfCarriers": 34 }, { "Fullness": 100, "FinishedFabricWidth": 146, "MinPC": 67, "MaxPC": 71, "StackBackWidth": 19.5, "NoOfCarriers": 34 }, { "Fullness": 80, "FinishedFabricWidth": 146, "MinPC": 75, "MaxPC": 79, "StackBackWidth": 19.5, "NoOfCarriers": 34 }, { "Fullness": 60, "FinishedFabricWidth": 146, "MinPC": 83, "MaxPC": 87, "StackBackWidth": 19.5, "NoOfCarriers": 34 }, { "Fullness": 120, "FinishedFabricWidth": 154.5, "MinPC": 64, "MaxPC": 66, "StackBackWidth": 20.25, "NoOfCarriers": 36 }, { "Fullness": 100, "FinishedFabricWidth": 154.5, "MinPC": 72, "MaxPC": 75, "StackBackWidth": 20.25, "NoOfCarriers": 36 }, { "Fullness": 80, "FinishedFabricWidth": 154.5, "MinPC": 80, "MaxPC": 84, "StackBackWidth": 20.25, "NoOfCarriers": 36 }, { "Fullness": 60, "FinishedFabricWidth": 154.5, "MinPC": 88, "MaxPC": 93, "StackBackWidth": 20.25, "NoOfCarriers": 36 }, { "Fullness": 120, "FinishedFabricWidth": 163, "MinPC": 67, "MaxPC": 70, "StackBackWidth": 21.25, "NoOfCarriers": 38 }, { "Fullness": 100, "FinishedFabricWidth": 163, "MinPC": 76, "MaxPC": 79, "StackBackWidth": 21.25, "NoOfCarriers": 38 }, { "Fullness": 80, "FinishedFabricWidth": 163, "MinPC": 85, "MaxPC": 89, "StackBackWidth": 21.25, "NoOfCarriers": 38 }, { "Fullness": 60, "FinishedFabricWidth": 163, "MinPC": 94, "MaxPC": 98, "StackBackWidth": 21.25, "NoOfCarriers": 38 }, { "Fullness": 120, "FinishedFabricWidth": 171.5, "MinPC": 71, "MaxPC": 74, "StackBackWidth": 22, "NoOfCarriers": 40 }, { "Fullness": 100, "FinishedFabricWidth": 171.5, "MinPC": 80, "MaxPC": 84, "StackBackWidth": 22, "NoOfCarriers": 40 }, { "Fullness": 80, "FinishedFabricWidth": 171.5, "MinPC": 90, "MaxPC": 93, "StackBackWidth": 22, "NoOfCarriers": 40 }, { "Fullness": 60, "FinishedFabricWidth": 171.5, "MinPC": 99, "MaxPC": 103, "StackBackWidth": 22, "NoOfCarriers": 40 }, { "Fullness": 120, "FinishedFabricWidth": 180, "MinPC": 75, "MaxPC": 78, "StackBackWidth": 22.75, "NoOfCarriers": 42 }, { "Fullness": 100, "FinishedFabricWidth": 180, "MinPC": 85, "MaxPC": 88, "StackBackWidth": 22.75, "NoOfCarriers": 42 }, { "Fullness": 80, "FinishedFabricWidth": 180, "MinPC": 94, "MaxPC": 98, "StackBackWidth": 22.75, "NoOfCarriers": 42 }, { "Fullness": 60, "FinishedFabricWidth": 180, "MinPC": 104, "MaxPC": 108, "StackBackWidth": 22.75, "NoOfCarriers": 42 }, { "Fullness": 120, "FinishedFabricWidth": 188.5, "MinPC": 79, "MaxPC": 81, "StackBackWidth": 23.5, "NoOfCarriers": 44 }, { "Fullness": 100, "FinishedFabricWidth": 188.5, "MinPC": 89, "MaxPC": 92, "StackBackWidth": 23.5, "NoOfCarriers": 44 }, { "Fullness": 80, "FinishedFabricWidth": 188.5, "MinPC": 99, "MaxPC": 103, "StackBackWidth": 23.5, "NoOfCarriers": 44 }, { "Fullness": 60, "FinishedFabricWidth": 188.5, "MinPC": 109, "MaxPC": 114, "StackBackWidth": 23.5, "NoOfCarriers": 44 }, { "Fullness": 120, "FinishedFabricWidth": 197, "MinPC": 82, "MaxPC": 85, "StackBackWidth": 24.25, "NoOfCarriers": 46 }, { "Fullness": 100, "FinishedFabricWidth": 197, "MinPC": 93, "MaxPC": 96, "StackBackWidth": 24.25, "NoOfCarriers": 46 }, { "Fullness": 80, "FinishedFabricWidth": 197, "MinPC": 104, "MaxPC": 108, "StackBackWidth": 24.25, "NoOfCarriers": 46 }, { "Fullness": 60, "FinishedFabricWidth": 197, "MinPC": 115, "MaxPC": 119, "StackBackWidth": 24.25, "NoOfCarriers": 46 }, { "Fullness": 120, "FinishedFabricWidth": 205.5, "MinPC": 86, "MaxPC": 89, "StackBackWidth": 25, "NoOfCarriers": 48 }, { "Fullness": 100, "FinishedFabricWidth": 205.5, "MinPC": 97, "MaxPC": 101, "StackBackWidth": 25, "NoOfCarriers": 48 }, { "Fullness": 80, "FinishedFabricWidth": 205.5, "MinPC": 109, "MaxPC": 112, "StackBackWidth": 25, "NoOfCarriers": 48 }, { "Fullness": 60, "FinishedFabricWidth": 205.5, "MinPC": 120, "MaxPC": 124, "StackBackWidth": 25, "NoOfCarriers": 48 }, { "Fullness": 120, "FinishedFabricWidth": 214, "MinPC": 90, "MaxPC": 93, "StackBackWidth": 25.75, "NoOfCarriers": 50 }, { "Fullness": 100, "FinishedFabricWidth": 214, "MinPC": 102, "MaxPC": 105, "StackBackWidth": 25.75, "NoOfCarriers": 50 }, { "Fullness": 80, "FinishedFabricWidth": 214, "MinPC": 113, "MaxPC": 117, "StackBackWidth": 25.75, "NoOfCarriers": 50 }, { "Fullness": 60, "FinishedFabricWidth": 214, "MinPC": 125, "MaxPC": 129, "StackBackWidth": 25.75, "NoOfCarriers": 50 }, { "Fullness": 120, "FinishedFabricWidth": 222.5, "MinPC": 94, "MaxPC": 96, "StackBackWidth": 26.5, "NoOfCarriers": 52 }, { "Fullness": 100, "FinishedFabricWidth": 222.5, "MinPC": 106, "MaxPC": 109, "StackBackWidth": 26.5, "NoOfCarriers": 52 }, { "Fullness": 80, "FinishedFabricWidth": 222.5, "MinPC": 118, "MaxPC": 122, "StackBackWidth": 26.5, "NoOfCarriers": 52 }, { "Fullness": 60, "FinishedFabricWidth": 222.5, "MinPC": 130, "MaxPC": 135, "StackBackWidth": 26.5, "NoOfCarriers": 52 }, { "Fullness": 120, "FinishedFabricWidth": 231, "MinPC": 97, "MaxPC": 100, "StackBackWidth": 27.25, "NoOfCarriers": 54 }, { "Fullness": 100, "FinishedFabricWidth": 231, "MinPC": 110, "MaxPC": 113, "StackBackWidth": 27.25, "NoOfCarriers": 54 }, { "Fullness": 80, "FinishedFabricWidth": 231, "MinPC": 123, "MaxPC": 127, "StackBackWidth": 27.25, "NoOfCarriers": 54 }, { "Fullness": 60, "FinishedFabricWidth": 231, "MinPC": 136, "MaxPC": 140, "StackBackWidth": 27.25, "NoOfCarriers": 54 }, { "Fullness": 120, "FinishedFabricWidth": 239.5, "MinPC": 101, "MaxPC": 104, "StackBackWidth": 28.25, "NoOfCarriers": 56 }, { "Fullness": 100, "FinishedFabricWidth": 239.5, "MinPC": 114, "MaxPC": 118, "StackBackWidth": 28.25, "NoOfCarriers": 56 }, { "Fullness": 80, "FinishedFabricWidth": 239.5, "MinPC": 128, "MaxPC": 131, "StackBackWidth": 28.25, "NoOfCarriers": 56 }, { "Fullness": 60, "FinishedFabricWidth": 239.5, "MinPC": 141, "MaxPC": 145, "StackBackWidth": 28.25, "NoOfCarriers": 56 }, { "Fullness": 120, "FinishedFabricWidth": 248, "MinPC": 105, "MaxPC": 108, "StackBackWidth": 29, "NoOfCarriers": 58 }, { "Fullness": 100, "FinishedFabricWidth": 248, "MinPC": 119, "MaxPC": 122, "StackBackWidth": 29, "NoOfCarriers": 58 }, { "Fullness": 80, "FinishedFabricWidth": 248, "MinPC": 132, "MaxPC": 136, "StackBackWidth": 29, "NoOfCarriers": 58 }, { "Fullness": 60, "FinishedFabricWidth": 248, "MinPC": 146, "MaxPC": 150, "StackBackWidth": 29, "NoOfCarriers": 58 }, { "Fullness": 120, "FinishedFabricWidth": 256.5, "MinPC": 109, "MaxPC": 111, "StackBackWidth": 30, "NoOfCarriers": 60 }, { "Fullness": 100, "FinishedFabricWidth": 256.5, "MinPC": 123, "MaxPC": 126, "StackBackWidth": 30, "NoOfCarriers": 60 }, { "Fullness": 80, "FinishedFabricWidth": 256.5, "MinPC": 137, "MaxPC": 141, "StackBackWidth": 30, "NoOfCarriers": 60 }, { "Fullness": 60, "FinishedFabricWidth": 256.5, "MinPC": 151, "MaxPC": 156, "StackBackWidth": 30, "NoOfCarriers": 60 }, { "Fullness": 120, "FinishedFabricWidth": 265, "MinPC": 112, "MaxPC": 115, "StackBackWidth": 31, "NoOfCarriers": 62 }, { "Fullness": 100, "FinishedFabricWidth": 265, "MinPC": 127, "MaxPC": 130, "StackBackWidth": 31, "NoOfCarriers": 62 }, { "Fullness": 80, "FinishedFabricWidth": 265, "MinPC": 142, "MaxPC": 146, "StackBackWidth": 31, "NoOfCarriers": 62 }, { "Fullness": 60, "FinishedFabricWidth": 265, "MinPC": 157, "MaxPC": 161, "StackBackWidth": 31, "NoOfCarriers": 62 }, { "Fullness": 120, "FinishedFabricWidth": 273.5, "MinPC": 116, "MaxPC": 119, "StackBackWidth": 31.75, "NoOfCarriers": 64 }, { "Fullness": 100, "FinishedFabricWidth": 273.5, "MinPC": 131, "MaxPC": 136, "StackBackWidth": 31.75, "NoOfCarriers": 64 }, { "Fullness": 80, "FinishedFabricWidth": 273.5, "MinPC": 147, "MaxPC": 150, "StackBackWidth": 31.75, "NoOfCarriers": 64 }, { "Fullness": 60, "FinishedFabricWidth": 273.5, "MinPC": 162, "MaxPC": 166, "StackBackWidth": 31.75, "NoOfCarriers": 64 }, { "Fullness": 120, "FinishedFabricWidth": 282, "MinPC": 120, "MaxPC": 123, "StackBackWidth": 32.75, "NoOfCarriers": 66 }, { "Fullness": 100, "FinishedFabricWidth": 282, "MinPC": 137, "MaxPC": 139, "StackBackWidth": 32.75, "NoOfCarriers": 66 }, { "Fullness": 80, "FinishedFabricWidth": 282, "MinPC": 151, "MaxPC": 155, "StackBackWidth": 32.75, "NoOfCarriers": 66 }, { "Fullness": 60, "FinishedFabricWidth": 282, "MinPC": 167, "MaxPC": 171, "StackBackWidth": 32.75, "NoOfCarriers": 66 }, { "Fullness": 120, "FinishedFabricWidth": 290.5, "MinPC": 124, "MaxPC": 126, "StackBackWidth": 33.5, "NoOfCarriers": 68 }, { "Fullness": 100, "FinishedFabricWidth": 290.5, "MinPC": 140, "MaxPC": 143, "StackBackWidth": 33.5, "NoOfCarriers": 68 }, { "Fullness": 80, "FinishedFabricWidth": 290.5, "MinPC": 156, "MaxPC": 160, "StackBackWidth": 33.5, "NoOfCarriers": 68 }, { "Fullness": 60, "FinishedFabricWidth": 290.5, "MinPC": 172, "MaxPC": 176, "StackBackWidth": 33.5, "NoOfCarriers": 68 }, { "Fullness": 120, "FinishedFabricWidth": 299, "MinPC": 127, "MaxPC": 130, "StackBackWidth": 34.5, "NoOfCarriers": 70 }, { "Fullness": 100, "FinishedFabricWidth": 299, "MinPC": 144, "MaxPC": 147, "StackBackWidth": 34.5, "NoOfCarriers": 70 }, { "Fullness": 80, "FinishedFabricWidth": 299, "MinPC": 161, "MaxPC": 165, "StackBackWidth": 34.5, "NoOfCarriers": 70 }, { "Fullness": 60, "FinishedFabricWidth": 299, "MinPC": 177, "MaxPC": 182, "StackBackWidth": 34.5, "NoOfCarriers": 70 }, { "Fullness": 120, "FinishedFabricWidth": 307.5, "MinPC": 131, "MaxPC": 134, "StackBackWidth": 35.25, "NoOfCarriers": 72 }, { "Fullness": 100, "FinishedFabricWidth": 307.5, "MinPC": 148, "MaxPC": 152, "StackBackWidth": 35.25, "NoOfCarriers": 72 }, { "Fullness": 80, "FinishedFabricWidth": 307.5, "MinPC": 166, "MaxPC": 169, "StackBackWidth": 35.25, "NoOfCarriers": 72 }, { "Fullness": 60, "FinishedFabricWidth": 307.5, "MinPC": 183, "MaxPC": 187, "StackBackWidth": 35.25, "NoOfCarriers": 72 }, { "Fullness": 120, "FinishedFabricWidth": 316, "MinPC": 135, "MaxPC": 138, "StackBackWidth": 36.25, "NoOfCarriers": 74 }, { "Fullness": 100, "FinishedFabricWidth": 316, "MinPC": 153, "MaxPC": 156, "StackBackWidth": 36.25, "NoOfCarriers": 74 }, { "Fullness": 80, "FinishedFabricWidth": 316, "MinPC": 170, "MaxPC": 174, "StackBackWidth": 36.25, "NoOfCarriers": 74 }, { "Fullness": 60, "FinishedFabricWidth": 316, "MinPC": 188, "MaxPC": 192, "StackBackWidth": 36.25, "NoOfCarriers": 74 }, { "Fullness": 120, "FinishedFabricWidth": 324.5, "MinPC": 139, "MaxPC": 141, "StackBackWidth": 37, "NoOfCarriers": 76 }, { "Fullness": 100, "FinishedFabricWidth": 324.5, "MinPC": 157, "MaxPC": 160, "StackBackWidth": 37, "NoOfCarriers": 76 }, { "Fullness": 80, "FinishedFabricWidth": 324.5, "MinPC": 175, "MaxPC": 179, "StackBackWidth": 37, "NoOfCarriers": 76 }, { "Fullness": 120, "FinishedFabricWidth": 333, "MinPC": 142, "MaxPC": 145, "StackBackWidth": 38, "NoOfCarriers": 78 }, { "Fullness": 100, "FinishedFabricWidth": 333, "MinPC": 161, "MaxPC": 164, "StackBackWidth": 38, "NoOfCarriers": 78 }, { "Fullness": 80, "FinishedFabricWidth": 333, "MinPC": 180, "MaxPC": 184, "StackBackWidth": 38, "NoOfCarriers": 78 }, { "Fullness": 120, "FinishedFabricWidth": 341.5, "MinPC": 146, "MaxPC": 149, "StackBackWidth": 39, "NoOfCarriers": 80 }, { "Fullness": 100, "FinishedFabricWidth": 341.5, "MinPC": 165, "MaxPC": 168, "StackBackWidth": 39, "NoOfCarriers": 80 }, { "Fullness": 80, "FinishedFabricWidth": 341.5, "MinPC": 185, "MaxPC": 188, "StackBackWidth": 39, "NoOfCarriers": 80 }, { "Fullness": 120, "FinishedFabricWidth": 350, "MinPC": 150, "MaxPC": 153, "StackBackWidth": 39.75, "NoOfCarriers": 82 }, { "Fullness": 100, "FinishedFabricWidth": 350, "MinPC": 169, "MaxPC": 173, "StackBackWidth": 39.75, "NoOfCarriers": 82 }, { "Fullness": 80, "FinishedFabricWidth": 350, "MinPC": 189, "MaxPC": 193, "StackBackWidth": 39.75, "NoOfCarriers": 82 }, { "Fullness": 120, "FinishedFabricWidth": 358.5, "MinPC": 154, "MaxPC": 156, "StackBackWidth": 40.75, "NoOfCarriers": 84 }, { "Fullness": 100, "FinishedFabricWidth": 358.5, "MinPC": 174, "MaxPC": 177, "StackBackWidth": 40.75, "NoOfCarriers": 84 }, { "Fullness": 120, "FinishedFabricWidth": 367, "MinPC": 157, "MaxPC": 160, "StackBackWidth": 41.5, "NoOfCarriers": 86 }, { "Fullness": 100, "FinishedFabricWidth": 367, "MinPC": 178, "MaxPC": 181, "StackBackWidth": 41.5, "NoOfCarriers": 86 }, { "Fullness": 120, "FinishedFabricWidth": 375.5, "MinPC": 161, "MaxPC": 164, "StackBackWidth": 42.5, "NoOfCarriers": 88 }, { "Fullness": 100, "FinishedFabricWidth": 375.5, "MinPC": 182, "MaxPC": 186, "StackBackWidth": 42.5, "NoOfCarriers": 88 }, { "Fullness": 120, "FinishedFabricWidth": 384, "MinPC": 165, "MaxPC": 168, "StackBackWidth": 43.25, "NoOfCarriers": 90 }, { "Fullness": 100, "FinishedFabricWidth": 384, "MinPC": 187, "MaxPC": 190, "StackBackWidth": 43.25, "NoOfCarriers": 90 }, { "Fullness": 120, "FinishedFabricWidth": 392.5, "MinPC": 169, "MaxPC": 171, "StackBackWidth": 44.25, "NoOfCarriers": 92 }, { "Fullness": 120, "FinishedFabricWidth": 401, "MinPC": 172, "MaxPC": 175, "StackBackWidth": 45.25, "NoOfCarriers": 94 }, { "Fullness": 120, "FinishedFabricWidth": 409.5, "MinPC": 176, "MaxPC": 179, "StackBackWidth": 46, "NoOfCarriers": 96 }, { "Fullness": 120, "FinishedFabricWidth": 418, "MinPC": 180, "MaxPC": 183, "StackBackWidth": 47, "NoOfCarriers": 98 }, { "Fullness": 120, "FinishedFabricWidth": 426.5, "MinPC": 184, "MaxPC": 186, "StackBackWidth": 48, "NoOfCarriers": 100 }, { "Fullness": 120, "FinishedFabricWidth": 435, "MinPC": 187, "MaxPC": 190, "StackBackWidth": 49.75, "NoOfCarriers": 102 }];
    var buttmasterRippleFoldChart = [{ "Fullness": 120, "FinishedFabricWidth": 34, "MinPC": 13, "MaxPC": 13, "StackBackWidth": 6, "NoOfCarriers": 8 }, { "Fullness": 100, "FinishedFabricWidth": 34, "MinPC": 13, "MaxPC": 14, "StackBackWidth": 6, "NoOfCarriers": 8 }, { "Fullness": 80, "FinishedFabricWidth": 34, "MinPC": 13, "MaxPC": 16, "StackBackWidth": 6, "NoOfCarriers": 8 }, { "Fullness": 60, "FinishedFabricWidth": 34, "MinPC": 16, "MaxPC": 18, "StackBackWidth": 6, "NoOfCarriers": 8 }, { "Fullness": 120, "FinishedFabricWidth": 42.5, "MinPC": 14, "MaxPC": 16, "StackBackWidth": 7, "NoOfCarriers": 10 }, { "Fullness": 100, "FinishedFabricWidth": 42.5, "MinPC": 15, "MaxPC": 19, "StackBackWidth": 7, "NoOfCarriers": 10 }, { "Fullness": 80, "FinishedFabricWidth": 42.5, "MinPC": 17, "MaxPC": 21, "StackBackWidth": 7, "NoOfCarriers": 10 }, { "Fullness": 60, "FinishedFabricWidth": 42.5, "MinPC": 19, "MaxPC": 23, "StackBackWidth": 7, "NoOfCarriers": 10 }, { "Fullness": 120, "FinishedFabricWidth": 51, "MinPC": 17, "MaxPC": 20, "StackBackWidth": 8.25, "NoOfCarriers": 12 }, { "Fullness": 100, "FinishedFabricWidth": 51, "MinPC": 20, "MaxPC": 23, "StackBackWidth": 8.25, "NoOfCarriers": 12 }, { "Fullness": 80, "FinishedFabricWidth": 51, "MinPC": 22, "MaxPC": 26, "StackBackWidth": 8.25, "NoOfCarriers": 12 }, { "Fullness": 60, "FinishedFabricWidth": 51, "MinPC": 24, "MaxPC": 28, "StackBackWidth": 8.25, "NoOfCarriers": 12 }, { "Fullness": 120, "FinishedFabricWidth": 59.5, "MinPC": 21, "MaxPC": 24, "StackBackWidth": 9.25, "NoOfCarriers": 14 }, { "Fullness": 100, "FinishedFabricWidth": 59.5, "MinPC": 24, "MaxPC": 27, "StackBackWidth": 9.25, "NoOfCarriers": 14 }, { "Fullness": 80, "FinishedFabricWidth": 59.5, "MinPC": 27, "MaxPC": 30, "StackBackWidth": 9.25, "NoOfCarriers": 14 }, { "Fullness": 60, "FinishedFabricWidth": 59.5, "MinPC": 29, "MaxPC": 34, "StackBackWidth": 9.25, "NoOfCarriers": 14 }, { "Fullness": 120, "FinishedFabricWidth": 68, "MinPC": 25, "MaxPC": 28, "StackBackWidth": 10.375, "NoOfCarriers": 16 }, { "Fullness": 100, "FinishedFabricWidth": 68, "MinPC": 28, "MaxPC": 31, "StackBackWidth": 10.375, "NoOfCarriers": 16 }, { "Fullness": 80, "FinishedFabricWidth": 68, "MinPC": 31, "MaxPC": 35, "StackBackWidth": 10.375, "NoOfCarriers": 16 }, { "Fullness": 60, "FinishedFabricWidth": 68, "MinPC": 35, "MaxPC": 39, "StackBackWidth": 10.375, "NoOfCarriers": 16 }, { "Fullness": 120, "FinishedFabricWidth": 76.5, "MinPC": 29, "MaxPC": 31, "StackBackWidth": 11.5, "NoOfCarriers": 18 }, { "Fullness": 100, "FinishedFabricWidth": 76.5, "MinPC": 32, "MaxPC": 36, "StackBackWidth": 11.5, "NoOfCarriers": 18 }, { "Fullness": 80, "FinishedFabricWidth": 76.5, "MinPC": 36, "MaxPC": 40, "StackBackWidth": 11.5, "NoOfCarriers": 18 }, { "Fullness": 60, "FinishedFabricWidth": 76.5, "MinPC": 40, "MaxPC": 44, "StackBackWidth": 11.5, "NoOfCarriers": 18 }, { "Fullness": 120, "FinishedFabricWidth": 85, "MinPC": 32, "MaxPC": 35, "StackBackWidth": 12.75, "NoOfCarriers": 20 }, { "Fullness": 100, "FinishedFabricWidth": 85, "MinPC": 37, "MaxPC": 40, "StackBackWidth": 12.75, "NoOfCarriers": 20 }, { "Fullness": 80, "FinishedFabricWidth": 85, "MinPC": 41, "MaxPC": 45, "StackBackWidth": 12.75, "NoOfCarriers": 20 }, { "Fullness": 60, "FinishedFabricWidth": 85, "MinPC": 45, "MaxPC": 49, "StackBackWidth": 12.75, "NoOfCarriers": 20 }, { "Fullness": 120, "FinishedFabricWidth": 93.5, "MinPC": 36, "MaxPC": 39, "StackBackWidth": 13.875, "NoOfCarriers": 22 }, { "Fullness": 100, "FinishedFabricWidth": 93.5, "MinPC": 41, "MaxPC": 44, "StackBackWidth": 13.875, "NoOfCarriers": 22 }, { "Fullness": 80, "FinishedFabricWidth": 93.5, "MinPC": 46, "MaxPC": 49, "StackBackWidth": 13.875, "NoOfCarriers": 22 }, { "Fullness": 60, "FinishedFabricWidth": 93.5, "MinPC": 50, "MaxPC": 55, "StackBackWidth": 13.875, "NoOfCarriers": 22 }, { "Fullness": 120, "FinishedFabricWidth": 102, "MinPC": 40, "MaxPC": 43, "StackBackWidth": 15, "NoOfCarriers": 24 }, { "Fullness": 100, "FinishedFabricWidth": 102, "MinPC": 45, "MaxPC": 48, "StackBackWidth": 15, "NoOfCarriers": 24 }, { "Fullness": 80, "FinishedFabricWidth": 102, "MinPC": 50, "MaxPC": 54, "StackBackWidth": 15, "NoOfCarriers": 24 }, { "Fullness": 60, "FinishedFabricWidth": 102, "MinPC": 56, "MaxPC": 60, "StackBackWidth": 15, "NoOfCarriers": 24 }, { "Fullness": 120, "FinishedFabricWidth": 110.5, "MinPC": 44, "MaxPC": 46, "StackBackWidth": 16.375, "NoOfCarriers": 26 }, { "Fullness": 100, "FinishedFabricWidth": 110.5, "MinPC": 49, "MaxPC": 53, "StackBackWidth": 16.375, "NoOfCarriers": 26 }, { "Fullness": 80, "FinishedFabricWidth": 110.5, "MinPC": 55, "MaxPC": 59, "StackBackWidth": 16.375, "NoOfCarriers": 26 }, { "Fullness": 60, "FinishedFabricWidth": 110.5, "MinPC": 61, "MaxPC": 65, "StackBackWidth": 16.375, "NoOfCarriers": 26 }, { "Fullness": 120, "FinishedFabricWidth": 119, "MinPC": 47, "MaxPC": 50, "StackBackWidth": 17.5, "NoOfCarriers": 28 }, { "Fullness": 100, "FinishedFabricWidth": 119, "MinPC": 54, "MaxPC": 57, "StackBackWidth": 17.5, "NoOfCarriers": 28 }, { "Fullness": 80, "FinishedFabricWidth": 119, "MinPC": 60, "MaxPC": 64, "StackBackWidth": 17.5, "NoOfCarriers": 28 }, { "Fullness": 60, "FinishedFabricWidth": 119, "MinPC": 66, "MaxPC": 70, "StackBackWidth": 17.5, "NoOfCarriers": 28 }, { "Fullness": 120, "FinishedFabricWidth": 127.5, "MinPC": 51, "MaxPC": 54, "StackBackWidth": 18.75, "NoOfCarriers": 30 }, { "Fullness": 100, "FinishedFabricWidth": 127.5, "MinPC": 58, "MaxPC": 61, "StackBackWidth": 18.75, "NoOfCarriers": 30 }, { "Fullness": 80, "FinishedFabricWidth": 127.5, "MinPC": 65, "MaxPC": 68, "StackBackWidth": 18.75, "NoOfCarriers": 30 }, { "Fullness": 60, "FinishedFabricWidth": 127.5, "MinPC": 71, "MaxPC": 76, "StackBackWidth": 18.75, "NoOfCarriers": 30 }, { "Fullness": 120, "FinishedFabricWidth": 136, "MinPC": 55, "MaxPC": 58, "StackBackWidth": 19.875, "NoOfCarriers": 32 }, { "Fullness": 100, "FinishedFabricWidth": 136, "MinPC": 62, "MaxPC": 65, "StackBackWidth": 19.875, "NoOfCarriers": 32 }, { "Fullness": 80, "FinishedFabricWidth": 136, "MinPC": 69, "MaxPC": 73, "StackBackWidth": 19.875, "NoOfCarriers": 32 }, { "Fullness": 60, "FinishedFabricWidth": 136, "MinPC": 77, "MaxPC": 81, "StackBackWidth": 19.875, "NoOfCarriers": 32 }, { "Fullness": 120, "FinishedFabricWidth": 144.5, "MinPC": 59, "MaxPC": 61, "StackBackWidth": 21, "NoOfCarriers": 34 }, { "Fullness": 100, "FinishedFabricWidth": 144.5, "MinPC": 66, "MaxPC": 70, "StackBackWidth": 21, "NoOfCarriers": 34 }, { "Fullness": 80, "FinishedFabricWidth": 144.5, "MinPC": 74, "MaxPC": 78, "StackBackWidth": 21, "NoOfCarriers": 34 }, { "Fullness": 60, "FinishedFabricWidth": 144.5, "MinPC": 82, "MaxPC": 86, "StackBackWidth": 21, "NoOfCarriers": 34 }, { "Fullness": 120, "FinishedFabricWidth": 153, "MinPC": 62, "MaxPC": 65, "StackBackWidth": 22.125, "NoOfCarriers": 36 }, { "Fullness": 100, "FinishedFabricWidth": 153, "MinPC": 71, "MaxPC": 74, "StackBackWidth": 22.125, "NoOfCarriers": 36 }, { "Fullness": 80, "FinishedFabricWidth": 153, "MinPC": 79, "MaxPC": 83, "StackBackWidth": 22.125, "NoOfCarriers": 36 }, { "Fullness": 60, "FinishedFabricWidth": 153, "MinPC": 87, "MaxPC": 91, "StackBackWidth": 22.125, "NoOfCarriers": 36 }, { "Fullness": 120, "FinishedFabricWidth": 161.5, "MinPC": 66, "MaxPC": 69, "StackBackWidth": 23.25, "NoOfCarriers": 38 }, { "Fullness": 100, "FinishedFabricWidth": 161.5, "MinPC": 75, "MaxPC": 78, "StackBackWidth": 23.25, "NoOfCarriers": 38 }, { "Fullness": 80, "FinishedFabricWidth": 161.5, "MinPC": 84, "MaxPC": 87, "StackBackWidth": 23.25, "NoOfCarriers": 38 }, { "Fullness": 60, "FinishedFabricWidth": 161.5, "MinPC": 92, "MaxPC": 97, "StackBackWidth": 23.25, "NoOfCarriers": 38 }, { "Fullness": 120, "FinishedFabricWidth": 170, "MinPC": 70, "MaxPC": 73, "StackBackWidth": 24.5, "NoOfCarriers": 40 }, { "Fullness": 100, "FinishedFabricWidth": 170, "MinPC": 79, "MaxPC": 82, "StackBackWidth": 24.5, "NoOfCarriers": 40 }, { "Fullness": 80, "FinishedFabricWidth": 170, "MinPC": 88, "MaxPC": 92, "StackBackWidth": 24.5, "NoOfCarriers": 40 }, { "Fullness": 60, "FinishedFabricWidth": 170, "MinPC": 98, "MaxPC": 102, "StackBackWidth": 24.5, "NoOfCarriers": 40 }, { "Fullness": 120, "FinishedFabricWidth": 178.5, "MinPC": 74, "MaxPC": 76, "StackBackWidth": 25.625, "NoOfCarriers": 42 }, { "Fullness": 100, "FinishedFabricWidth": 178.5, "MinPC": 83, "MaxPC": 87, "StackBackWidth": 25.625, "NoOfCarriers": 42 }, { "Fullness": 80, "FinishedFabricWidth": 178.5, "MinPC": 93, "MaxPC": 97, "StackBackWidth": 25.625, "NoOfCarriers": 42 }, { "Fullness": 60, "FinishedFabricWidth": 178.5, "MinPC": 103, "MaxPC": 107, "StackBackWidth": 25.625, "NoOfCarriers": 42 }, { "Fullness": 120, "FinishedFabricWidth": 187, "MinPC": 77, "MaxPC": 80, "StackBackWidth": 26.875, "NoOfCarriers": 44 }, { "Fullness": 100, "FinishedFabricWidth": 187, "MinPC": 88, "MaxPC": 91, "StackBackWidth": 26.875, "NoOfCarriers": 44 }, { "Fullness": 80, "FinishedFabricWidth": 187, "MinPC": 98, "MaxPC": 102, "StackBackWidth": 26.875, "NoOfCarriers": 44 }, { "Fullness": 60, "FinishedFabricWidth": 187, "MinPC": 108, "MaxPC": 112, "StackBackWidth": 26.875, "NoOfCarriers": 44 }, { "Fullness": 120, "FinishedFabricWidth": 195, "MinPC": 81, "MaxPC": 84, "StackBackWidth": 28, "NoOfCarriers": 46 }, { "Fullness": 100, "FinishedFabricWidth": 195, "MinPC": 92, "MaxPC": 95, "StackBackWidth": 28, "NoOfCarriers": 46 }, { "Fullness": 80, "FinishedFabricWidth": 195, "MinPC": 103, "MaxPC": 106, "StackBackWidth": 28, "NoOfCarriers": 46 }, { "Fullness": 60, "FinishedFabricWidth": 195, "MinPC": 113, "MaxPC": 118, "StackBackWidth": 28, "NoOfCarriers": 46 }, { "Fullness": 120, "FinishedFabricWidth": 204, "MinPC": 85, "MaxPC": 88, "StackBackWidth": 29.25, "NoOfCarriers": 48 }, { "Fullness": 100, "FinishedFabricWidth": 204, "MinPC": 96, "MaxPC": 99, "StackBackWidth": 29.25, "NoOfCarriers": 48 }, { "Fullness": 80, "FinishedFabricWidth": 204, "MinPC": 107, "MaxPC": 111, "StackBackWidth": 29.25, "NoOfCarriers": 48 }, { "Fullness": 60, "FinishedFabricWidth": 204, "MinPC": 119, "MaxPC": 123, "StackBackWidth": 29.25, "NoOfCarriers": 48 }, { "Fullness": 120, "FinishedFabricWidth": 212.5, "MinPC": 89, "MaxPC": 91, "StackBackWidth": 30.375, "NoOfCarriers": 50 }, { "Fullness": 100, "FinishedFabricWidth": 212.5, "MinPC": 100, "MaxPC": 104, "StackBackWidth": 30.375, "NoOfCarriers": 50 }, { "Fullness": 80, "FinishedFabricWidth": 212.5, "MinPC": 112, "MaxPC": 116, "StackBackWidth": 30.375, "NoOfCarriers": 50 }, { "Fullness": 60, "FinishedFabricWidth": 212.5, "MinPC": 124, "MaxPC": 128, "StackBackWidth": 30.375, "NoOfCarriers": 50 }, { "Fullness": 120, "FinishedFabricWidth": 221, "MinPC": 92, "MaxPC": 95, "StackBackWidth": 31.5, "NoOfCarriers": 52 }, { "Fullness": 100, "FinishedFabricWidth": 221, "MinPC": 105, "MaxPC": 108, "StackBackWidth": 31.5, "NoOfCarriers": 52 }, { "Fullness": 80, "FinishedFabricWidth": 221, "MinPC": 117, "MaxPC": 121, "StackBackWidth": 31.5, "NoOfCarriers": 52 }, { "Fullness": 60, "FinishedFabricWidth": 221, "MinPC": 129, "MaxPC": 133, "StackBackWidth": 31.5, "NoOfCarriers": 52 }, { "Fullness": 120, "FinishedFabricWidth": 229.5, "MinPC": 96, "MaxPC": 99, "StackBackWidth": 32.625, "NoOfCarriers": 54 }, { "Fullness": 100, "FinishedFabricWidth": 229.5, "MinPC": 109, "MaxPC": 112, "StackBackWidth": 32.625, "NoOfCarriers": 54 }, { "Fullness": 80, "FinishedFabricWidth": 229.5, "MinPC": 122, "MaxPC": 125, "StackBackWidth": 32.625, "NoOfCarriers": 54 }, { "Fullness": 60, "FinishedFabricWidth": 229.5, "MinPC": 134, "MaxPC": 139, "StackBackWidth": 32.625, "NoOfCarriers": 54 }, { "Fullness": 120, "FinishedFabricWidth": 238, "MinPC": 100, "MaxPC": 103, "StackBackWidth": 33.75, "NoOfCarriers": 56 }, { "Fullness": 100, "FinishedFabricWidth": 238, "MinPC": 113, "MaxPC": 116, "StackBackWidth": 33.75, "NoOfCarriers": 56 }, { "Fullness": 80, "FinishedFabricWidth": 238, "MinPC": 126, "MaxPC": 130, "StackBackWidth": 33.75, "NoOfCarriers": 56 }, { "Fullness": 60, "FinishedFabricWidth": 238, "MinPC": 140, "MaxPC": 144, "StackBackWidth": 33.75, "NoOfCarriers": 56 }, { "Fullness": 120, "FinishedFabricWidth": 246.5, "MinPC": 104, "MaxPC": 106, "StackBackWidth": 35, "NoOfCarriers": 58 }, { "Fullness": 100, "FinishedFabricWidth": 246.5, "MinPC": 117, "MaxPC": 121, "StackBackWidth": 35, "NoOfCarriers": 58 }, { "Fullness": 80, "FinishedFabricWidth": 246.5, "MinPC": 131, "MaxPC": 135, "StackBackWidth": 35, "NoOfCarriers": 58 }, { "Fullness": 60, "FinishedFabricWidth": 246.5, "MinPC": 145, "MaxPC": 149, "StackBackWidth": 35, "NoOfCarriers": 58 }, { "Fullness": 120, "FinishedFabricWidth": 255, "MinPC": 107, "MaxPC": 110, "StackBackWidth": 36, "NoOfCarriers": 60 }, { "Fullness": 100, "FinishedFabricWidth": 255, "MinPC": 122, "MaxPC": 125, "StackBackWidth": 36, "NoOfCarriers": 60 }, { "Fullness": 80, "FinishedFabricWidth": 255, "MinPC": 136, "MaxPC": 140, "StackBackWidth": 36, "NoOfCarriers": 60 }, { "Fullness": 60, "FinishedFabricWidth": 255, "MinPC": 150, "MaxPC": 154, "StackBackWidth": 36, "NoOfCarriers": 60 }, { "Fullness": 120, "FinishedFabricWidth": 263.5, "MinPC": 111, "MaxPC": 114, "StackBackWidth": 37.75, "NoOfCarriers": 62 }, { "Fullness": 100, "FinishedFabricWidth": 263.5, "MinPC": 126, "MaxPC": 129, "StackBackWidth": 37.75, "NoOfCarriers": 62 }, { "Fullness": 80, "FinishedFabricWidth": 263.5, "MinPC": 141, "MaxPC": 144, "StackBackWidth": 37.75, "NoOfCarriers": 62 }, { "Fullness": 60, "FinishedFabricWidth": 263.5, "MinPC": 155, "MaxPC": 160, "StackBackWidth": 37.75, "NoOfCarriers": 62 }, { "Fullness": 120, "FinishedFabricWidth": 272, "MinPC": 115, "MaxPC": 118, "StackBackWidth": 38.5, "NoOfCarriers": 64 }, { "Fullness": 100, "FinishedFabricWidth": 272, "MinPC": 130, "MaxPC": 133, "StackBackWidth": 38.5, "NoOfCarriers": 64 }, { "Fullness": 80, "FinishedFabricWidth": 272, "MinPC": 145, "MaxPC": 149, "StackBackWidth": 38.5, "NoOfCarriers": 64 }, { "Fullness": 60, "FinishedFabricWidth": 272, "MinPC": 161, "MaxPC": 165, "StackBackWidth": 38.5, "NoOfCarriers": 64 }, { "Fullness": 120, "FinishedFabricWidth": 280.5, "MinPC": 119, "MaxPC": 121, "StackBackWidth": 39.5, "NoOfCarriers": 66 }, { "Fullness": 100, "FinishedFabricWidth": 280.5, "MinPC": 134, "MaxPC": 138, "StackBackWidth": 39.5, "NoOfCarriers": 66 }, { "Fullness": 80, "FinishedFabricWidth": 280.5, "MinPC": 150, "MaxPC": 154, "StackBackWidth": 39.5, "NoOfCarriers": 66 }, { "Fullness": 60, "FinishedFabricWidth": 280.5, "MinPC": 166, "MaxPC": 170, "StackBackWidth": 39.5, "NoOfCarriers": 66 }, { "Fullness": 120, "FinishedFabricWidth": 289, "MinPC": 122, "MaxPC": 125, "StackBackWidth": 40.75, "NoOfCarriers": 68 }, { "Fullness": 100, "FinishedFabricWidth": 289, "MinPC": 139, "MaxPC": 142, "StackBackWidth": 40.75, "NoOfCarriers": 68 }, { "Fullness": 80, "FinishedFabricWidth": 289, "MinPC": 155, "MaxPC": 159, "StackBackWidth": 40.75, "NoOfCarriers": 68 }, { "Fullness": 60, "FinishedFabricWidth": 289, "MinPC": 171, "MaxPC": 175, "StackBackWidth": 40.75, "NoOfCarriers": 68 }, { "Fullness": 120, "FinishedFabricWidth": 297.5, "MinPC": 126, "MaxPC": 129, "StackBackWidth": 42, "NoOfCarriers": 70 }, { "Fullness": 100, "FinishedFabricWidth": 297.5, "MinPC": 143, "MaxPC": 146, "StackBackWidth": 42, "NoOfCarriers": 70 }, { "Fullness": 80, "FinishedFabricWidth": 297.5, "MinPC": 160, "MaxPC": 163, "StackBackWidth": 42, "NoOfCarriers": 70 }, { "Fullness": 60, "FinishedFabricWidth": 297.5, "MinPC": 176, "MaxPC": 181, "StackBackWidth": 42, "NoOfCarriers": 70 }, { "Fullness": 120, "FinishedFabricWidth": 306, "MinPC": 130, "MaxPC": 133, "StackBackWidth": 43, "NoOfCarriers": 72 }, { "Fullness": 100, "FinishedFabricWidth": 306, "MinPC": 147, "MaxPC": 150, "StackBackWidth": 43, "NoOfCarriers": 72 }, { "Fullness": 80, "FinishedFabricWidth": 306, "MinPC": 164, "MaxPC": 168, "StackBackWidth": 43, "NoOfCarriers": 72 }, { "Fullness": 60, "FinishedFabricWidth": 306, "MinPC": 182, "MaxPC": 186, "StackBackWidth": 43, "NoOfCarriers": 72 }, { "Fullness": 120, "FinishedFabricWidth": 314.5, "MinPC": 134, "MaxPC": 136, "StackBackWidth": 44.25, "NoOfCarriers": 74 }, { "Fullness": 100, "FinishedFabricWidth": 314.5, "MinPC": 151, "MaxPC": 155, "StackBackWidth": 44.25, "NoOfCarriers": 74 }, { "Fullness": 80, "FinishedFabricWidth": 314.5, "MinPC": 169, "MaxPC": 173, "StackBackWidth": 44.25, "NoOfCarriers": 74 }, { "Fullness": 60, "FinishedFabricWidth": 314.5, "MinPC": 187, "MaxPC": 191, "StackBackWidth": 44.25, "NoOfCarriers": 74 }, { "Fullness": 120, "FinishedFabricWidth": 323, "MinPC": 137, "MaxPC": 140, "StackBackWidth": 45.375, "NoOfCarriers": 76 }, { "Fullness": 100, "FinishedFabricWidth": 323, "MinPC": 156, "MaxPC": 159, "StackBackWidth": 45.375, "NoOfCarriers": 76 }, { "Fullness": 80, "FinishedFabricWidth": 323, "MinPC": 174, "MaxPC": 178, "StackBackWidth": 45.375, "NoOfCarriers": 76 }, { "Fullness": 60, "FinishedFabricWidth": 323, "MinPC": 192, "MaxPC": 196, "StackBackWidth": 45.375, "NoOfCarriers": 76 }, { "Fullness": 120, "FinishedFabricWidth": 331.5, "MinPC": 141, "MaxPC": 144, "StackBackWidth": 46.5, "NoOfCarriers": 78 }, { "Fullness": 100, "FinishedFabricWidth": 331.5, "MinPC": 160, "MaxPC": 163, "StackBackWidth": 46.5, "NoOfCarriers": 78 }, { "Fullness": 80, "FinishedFabricWidth": 331.5, "MinPC": 179, "MaxPC": 182, "StackBackWidth": 46.5, "NoOfCarriers": 78 }, { "Fullness": 120, "FinishedFabricWidth": 340, "MinPC": 145, "MaxPC": 148, "StackBackWidth": 47.75, "NoOfCarriers": 80 }, { "Fullness": 100, "FinishedFabricWidth": 340, "MinPC": 164, "MaxPC": 167, "StackBackWidth": 47.75, "NoOfCarriers": 80 }, { "Fullness": 80, "FinishedFabricWidth": 340, "MinPC": 183, "MaxPC": 187, "StackBackWidth": 47.75, "NoOfCarriers": 80 }, { "Fullness": 120, "FinishedFabricWidth": 348.5, "MinPC": 149, "MaxPC": 151, "StackBackWidth": 48.875, "NoOfCarriers": 82 }, { "Fullness": 100, "FinishedFabricWidth": 348.5, "MinPC": 168, "MaxPC": 172, "StackBackWidth": 48.875, "NoOfCarriers": 82 }, { "Fullness": 80, "FinishedFabricWidth": 348.5, "MinPC": 188, "MaxPC": 192, "StackBackWidth": 48.875, "NoOfCarriers": 82 }, { "Fullness": 120, "FinishedFabricWidth": 357, "MinPC": 152, "MaxPC": 155, "StackBackWidth": 50, "NoOfCarriers": 84 }, { "Fullness": 100, "FinishedFabricWidth": 357, "MinPC": 173, "MaxPC": 176, "StackBackWidth": 50, "NoOfCarriers": 84 }, { "Fullness": 80, "FinishedFabricWidth": 357, "MinPC": 193, "MaxPC": 197, "StackBackWidth": 50, "NoOfCarriers": 84 }, { "Fullness": 120, "FinishedFabricWidth": 365.5, "MinPC": 156, "MaxPC": 159, "StackBackWidth": 51.25, "NoOfCarriers": 86 }, { "Fullness": 100, "FinishedFabricWidth": 365.5, "MinPC": 177, "MaxPC": 180, "StackBackWidth": 51.25, "NoOfCarriers": 86 }, { "Fullness": 120, "FinishedFabricWidth": 374, "MinPC": 160, "MaxPC": 163, "StackBackWidth": 52.375, "NoOfCarriers": 88 }, { "Fullness": 100, "FinishedFabricWidth": 374, "MinPC": 181, "MaxPC": 184, "StackBackWidth": 52.375, "NoOfCarriers": 88 }, { "Fullness": 120, "FinishedFabricWidth": 382.5, "MinPC": 164, "MaxPC": 166, "StackBackWidth": 53.5, "NoOfCarriers": 90 }, { "Fullness": 100, "FinishedFabricWidth": 382.5, "MinPC": 185, "MaxPC": 189, "StackBackWidth": 53.5, "NoOfCarriers": 90 }, { "Fullness": 120, "FinishedFabricWidth": 391, "MinPC": 167, "MaxPC": 170, "StackBackWidth": 54.625, "NoOfCarriers": 92 }, { "Fullness": 100, "FinishedFabricWidth": 391, "MinPC": 190, "MaxPC": 193, "StackBackWidth": 54.625, "NoOfCarriers": 92 }, { "Fullness": 120, "FinishedFabricWidth": 399.5, "MinPC": 171, "MaxPC": 174, "StackBackWidth": 55.875, "NoOfCarriers": 94 }, { "Fullness": 120, "FinishedFabricWidth": 408, "MinPC": 175, "MaxPC": 178, "StackBackWidth": 57, "NoOfCarriers": 96 }, { "Fullness": 120, "FinishedFabricWidth": 416.5, "MinPC": 179, "MaxPC": 181, "StackBackWidth": 58.25, "NoOfCarriers": 98 }, { "Fullness": 120, "FinishedFabricWidth": 425, "MinPC": 182, "MaxPC": 185, "StackBackWidth": 59.375, "NoOfCarriers": 100 }, { "Fullness": 120, "FinishedFabricWidth": 433.5, "MinPC": 186, "MaxPC": 189, "StackBackWidth": 60.5, "NoOfCarriers": 102 }, { "Fullness": 120, "FinishedFabricWidth": 442, "MinPC": 190, "MaxPC": 193, "StackBackWidth": 61.625, "NoOfCarriers": 104 }];

    $(function () {
        $(".datepicker").datepicker();
        dialog = $("#dialogOrderDetail").dialog({
            autoOpen: false,
            modal: true,
            height: "auto",
            width: 500,
            buttons: {
                "Save": saveOrderDetailAndClose,
                "Save & Add New": saveAndNewDetail,
                "Save & Review": saveAndReview,
                Cancel: function () {
                    dialog.dialog("close");
                }
            }
        });
        dialogReview = $("#dialogReviewOrderDetail").dialog({
            autoOpen: false,
            modal: true,
            height: "auto",
            width: 1000,
            buttons: {
                Close: function () {
                    dialogReview.dialog("close");
                }
            }
        });
        $("#btnAddDetail").click(function () {
            if (orderDetails.length >= 7) {
                alert('We allow only 7 line items in an Order, if you need more than 7 then please create another order or call us!');
            }
            else {
                var obj = {
                    Line: orderDetails.length + 1,
                    RoomLocation: "",
                    Qty: 1,
                    Type: "Butt-Master Carriers",
                    CoverredArea: "",
                    Fullness: "120",
                    FabricWidth: "",
                    NoOfWidth: "",
                    NoOfButtons: "",
                    OverlapButtonLocation: "",
                    FinishedLength: "",
                    Return: "",
                    FabricNameColor: "",
                    LiningNameColor: "",
                }
                isAdding = true;
                loadDetail(obj);
                allFields.removeClass("ui-state-error");
                tips.empty();
                $("#dialogOrderDetail").dialog("option", "title", "Add Order Detail").dialog("open");
            }

        });
        $("#tbOrderDetail a.edit").live("click", function () {
            var index = parseInt($(this).attr("myindex"));
            var obj = orderDetails[index];
            obj.Line = index + 1;
            isAdding = false;
            loadDetail(obj);
            allFields.removeClass("ui-state-error");
            $("#dialogOrderDetail").dialog("option", "title", "Edit Order Detail").dialog("open");
            return false;
        });
        $("#tbOrderDetail a.delete").live("click", function () {
            if (confirm("Do you want to delete this item?")) {
                orderDetails.splice(parseInt($(this).attr("myindex")), 1);
                $("#hdOrderDetail").val(JSON.stringify(orderDetails));
                loadGrid();
            }

            return false;
        });
        $("#tbReviewOrderDetail a.edit").live("click", function () {
            var index = parseInt($(this).attr("myindex"));
            var obj = orderDetails[index];
            obj.Line = index + 1;
            isAdding = false;
            loadDetail(obj);
            allFields.removeClass("ui-state-error");
            $("#dialogOrderDetail").dialog("option", "title", "Edit Order Detail").dialog("open");
            $("#dialogReviewOrderDetail").dialog("close");
            return false;
        });
        $("#tbReviewOrderDetail a.delete").live("click", function () {
            if (confirm("Do you want to delete this item?")) {
                orderDetails.splice(parseInt($(this).attr("myindex")), 1);
                $("#hdOrderDetail").val(JSON.stringify(orderDetails));
                loadGrid();
                loadReviewGrid();
            }

            return false;
        });
        $("#btnReviewDetail").click(function () {
            loadReviewGrid();
            dialogReview.dialog("open");
        });
        $("#ddlType,#txtCoverredArea,#ddlFullness,#txtFabricWidth").change(function () {
            calculateNoOfWidth();
        });
        $("a.toggle-btn").live('click', function () {
            if ($(this).hasClass('collapsed')) {
                $(this).children('i').removeClass('glyphicon-minus-sign').addClass('glyphicon-plus-sign');
            }
            else {
                $(this).children('i').removeClass('glyphicon-plus-sign').addClass('glyphicon-minus-sign');
            }
        });
        function saveOrderDetail() {
            var valid = validateDetailForm();
            if (valid) {
                var objDetail = {
                    RoomLocation: _roomLocation.val(),
                    Qty: _qty.val(),
                    Type: _type.val(),
                    CoverredArea: _coverredArea.val(),
                    Fullness: _fullness.val(),
                    FabricWidth: _fabricWidth.val(),
                    NoOfWidth: _noOfWidth.val(),
                    NoOfButtons: _noOfBottons.val(),
                    OverlapButtonLocation: _overlapButtonLocation.val(),
                    FinishedLength: _finishedLength.val(),
                    Return: _return.val(),
                    FabricNameColor: _fabricNameColor.val(),
                    LiningNameColor: _liningNameColor.val(),

                };
                if (isAdding) {//add
                    orderDetails.push(objDetail);
                }
                else {//edit
                    orderDetails[parseInt(_line.text()) - 1] = objDetail;
                }
                $("#hdOrderDetail").val(JSON.stringify(orderDetails));
                loadGrid();
            }
            return valid;
        }
        function saveOrderDetailAndClose() {
            var valid = saveOrderDetail();
            if (valid) {
                dialog.dialog("close");
            }
            return valid;
        }
        function saveAndReview() {
            var valid = saveOrderDetail();
            if (valid) {
                dialog.dialog("close");
                loadReviewGrid();
                dialogReview.dialog("open");
            }
            return valid;

        }
        function validateDetailForm() {
            var valid = true;
            allFields.removeClass("ui-state-error");
            valid = valid && checkNumber(_qty, "Quantity", true, 1);
            valid = valid && checkNumber(_coverredArea, "Coverred Area", true, 1);
            valid = valid && checkNumber(_fabricWidth, "Fabric Width", true, 1);
            valid = valid && checkNumber(_noOfWidth, "No. of Width per Panel", true, 0);
            valid = valid && checkNumber(_noOfBottons, "No. of Buttons Required", false, 0);
            valid = valid && checkFraction(_finishedLength, "Finished Length", true, 0);
            valid = valid && checkFraction(_return, "Return", false, 0);

            return valid;
        }
        function saveAndNewDetail() {
            var valid = saveOrderDetail();
            if (valid) {
                if (orderDetails.length >= 9) {
                    dialog.dialog("close");
                }
                else {
                    var obj = {
                        Line: orderDetails.length + 1,
                        RoomLocation: "",
                        Qty: 1,
                        Type: "Butt-Master Carriers",
                        CoverredArea: "",
                        Fullness: "120",
                        FabricWidth: "",
                        NoOfWidth: "",
                        NoOfButtons: "",
                        OverlapButtonLocation: "",
                        FinishedLength: "",
                        Return: "",
                        FabricNameColor: "",
                        LiningNameColor: "",
                    }
                    isAdding = true;
                    loadDetail(obj);
                    allFields.removeClass("ui-state-error");
                    tips.empty();
                    $("#dialogOrderDetail").dialog("option", "title", "Add Order Detail");
                }
            }
            return valid;

        }
        function checkNumber(o, n, isRequired, min) {
            if (o.val() === '' && isRequired) {
                o.addClass("ui-state-error");
                updateTips(n + " cannot empty");
                return false;
            }
            if (isNaN(o.val())) {
                o.addClass("ui-state-error");
                updateTips(n + " must be number");
                return false;
            }
            if (parseFloat(o.val()) < min) {
                o.addClass("ui-state-error");
                updateTips(n + " must be larger than " + min);
                return false;
            } else {
                return true;
            }
        }
        function checkFraction(o, n, isRequired, min) {
            if (o.val() === '' && isRequired) {
                o.addClass("ui-state-error");
                updateTips(n + " cannot empty");
                return false;
            }
            var _arrNo = o.val().split(' ');
            if (_arrNo.length > 2) {
                o.addClass("ui-state-error");
                updateTips(n + " must be number or fraction");
                return false;
            }
            var no1 = _arrNo[0];
            if (isNaN(no1)) {
                o.addClass("ui-state-error");
                updateTips(n + " must be number or fraction");
                return false;
            }
            if (_arrNo.length === 1) {
                if (parseFloat(no1) < min) {
                    o.addClass("ui-state-error");
                    updateTips(n + " must be larger than " + min);
                    return false;
                }
            }
            else {
                var no2 = _arrNo[1];
                try {
                    var f2 = math.fraction(no2);
                    if (parseFloat(no1) + f2 < min) {
                        o.addClass("ui-state-error");
                        updateTips(n + " must be larger than " + min);
                        return false;
                    }
                } catch (e) {
                    o.addClass("ui-state-error");
                    updateTips(n + " must be number or fraction");
                    return false;
                }



            }

            return true;
        }
        function updateTips(t) {
            tips
                .text(t)
                .addClass("ui-state-highlight");
            setTimeout(function () {
                tips.removeClass("ui-state-highlight", 1500);
            }, 500);
        }
        function loadDetail(obj) {
            _line.text(obj.Line);
            _roomLocation.val(obj.RoomLocation);
            _qty.val(obj.Qty);
            _type.val(obj.Type);
            _coverredArea.val(obj.CoverredArea);
            _fullness.val(obj.Fullness);
            _fabricWidth.val(obj.FabricWidth);
            _noOfWidth.val(obj.NoOfWidth);
            _noOfBottons.val(obj.NoOfButtons);
            _overlapButtonLocation.val(obj.OverlapButtonLocation);
            _finishedLength.val(obj.FinishedLength);
            _return.val(obj.Return);
            _fabricNameColor.val(obj.FabricNameColor);
            _liningNameColor.val(obj.LiningNameColor);
        }

        function loadGrid() {
            $("#tbOrderDetail tbody").empty();
            if (orderDetails.length === 0) {
                $("#tbOrderDetail tbody").html('<tr><td colspan="9" class="text-center">No data to display</td></tr>');
            }
            else {
                $.each(orderDetails, function (i, val) {
                    var _content = '<tr>';
                    _content += '<td><a href="#" class="edit" myIndex="' + i + '">Edit</a> | <a href="#" class="delete" myIndex="' + i + '">Delete</a></td>';
                    _content += '<td>' + (i + 1) + '</td>';
                    _content += '<td>' + val.RoomLocation + '</td>';
                    _content += '<td>' + val.Qty + '</td>';
                    _content += '<td>' + val.Type + '</td>';
                    _content += '<td>' + val.CoverredArea + '</td>';
                    _content += '<td>' + val.Fullness + '</td>';
                    _content += '<td>' + val.FinishedLength + '</td>';
                    _content += '<td>' + val.Return + '</td>';

                    _content += '</tr>';

                    $("#tbOrderDetail tbody").append(_content);
                });

            }
        }
        function loadReviewGrid() {
            $("#tbReviewOrderDetail tbody").empty();
            if (orderDetails.length === 0) {
                $("#tbReviewOrderDetail tbody").html('<tr><td colspan="14" class="text-center">No data to display</td></tr>');
            }
            else {
                $.each(orderDetails, function (i, val) {
                    var _content = '<tr>';
                    _content += '<td><a href="javascript:void(0);" data-toggle="collapse" data-target="#detail_' + i + '" class="accordion-toggle toggle-btn"><i class="glyphicon glyphicon-plus-sign"></i></a></td> ';
                    _content += '<td><a href="#" class="edit" myindex="' + i + '">Edit</a> | <a href="#" class="delete" myindex="' + i + '">Delete</a></td>';
                    _content += '<td>' + (i + 1) + '</td>';
                    _content += '<td>' + val.RoomLocation + '</td>';
                    _content += '<td>' + val.Qty + '</td>';
                    _content += '<td>' + val.Type + '</td>';
                    _content += '<td>' + val.CoverredArea + '</td>';
                    _content += '<td>' + val.Fullness + '</td>';
                    _content += '<td>' + val.FabricWidth + '</td>';
                    _content += '<tr class="accordian-body collapse" id="detail_' + i + '">';
                    _content += '<td colspan="9">';
                    _content += '<div>';
                    _content += '<table style="width:100%" >';

                    _content += '<tr>';
                    _content += '<td>Room Locations:</td>';
                    _content += '<td>' + val.RoomLocation + '</td>';
                    _content += '<td style="width:50px"></td>';
                    _content += '<td>Qty:</td>';
                    _content += '<td>' + val.Qty + '</td>';
                    _content += '</tr>';

                    _content += '<tr>';
                    _content += '<td>Type:</td>';
                    _content += '<td>' + val.Type + '</td>';
                    _content += '<td></td>';
                    _content += '<td>Coverred Area:</td>';
                    _content += '<td>' + val.CoverredArea + '</td>';
                    _content += '</tr>';

                    _content += '<tr>';
                    _content += '<td>Persentage % Fullness:</td>';
                    _content += '<td>' + val.Fullness + '</td>';
                    _content += '<td></td>';
                    _content += '<td>Fabric Width per Panel:</td>';
                    _content += '<td>' + val.FabricWidth + '</td>';
                    _content += '</tr>';

                    _content += '<tr>';
                    _content += '<td>No. of Width per Panel:</td>';
                    _content += '<td>' + val.NoOfWidth + '</td>';
                    _content += '<td></td>';
                    _content += '<td>No. of Bottons Required:</td>';
                    _content += '<td>' + val.NoOfButtons + '</td>';
                    _content += '</tr>';
                    _content += '<tr>';
                    _content += '<td>Finished Length:</td>';
                    _content += '<td>' + val.FinishedLength + '</td>';
                    _content += '<td></td>';
                    _content += '<td>Return:</td>';
                    _content += '<td>' + val.Return + '</td>';
                    _content += '</tr>';

                    _content += '<tr>';
                    _content += '<td>Fabric Name & Color:</td>';
                    _content += '<td>' + val.FabricNameColor + '</td>';
                    _content += '<td></td>';
                    _content += '<td>Lining Name & Color:</td>';
                    _content += '<td>' + val.LiningNameColor + '</td>';
                    _content += '</tr>';

                    _content += '</table>';
                    _content += '</div>';
                    _content += '</td>';

                    _content += '</tr>';
                    $("#tbReviewOrderDetail>tbody").append(_content);
                });
            }
        }
        function calculateNoOfWidth() {
            var noOfWidth = 0;
            var finishedFabricWidth = 0;
            var fullness = parseInt(_fullness.val());
            var coverredArea = parseFloat(_coverredArea.val());
            if (_fabricWidth.val() !== "" && _coverredArea.val() !== "") {
                var fabricWidth = parseFloat(_fabricWidth.val());
                if (_type.val() === "Butt-Master Carriers") {
                    var buttMasterFilter = buttmasterRippleFoldChart.filter(function (d) {
                        return d.Fullness === fullness && d.MinPC <= coverredArea && d.MaxPC >= coverredArea
                    });
                    if (buttMasterFilter.length > 0) {
                        finishedFabricWidth = buttMasterFilter[0].FinishedFabricWidth;
                    }
                }
                else {
                    var overlapFilter = overlapRippleFoldChart.filter(function (d) {
                        return d.Fullness === fullness && d.MinPC <= coverredArea && d.MaxPC >= coverredArea
                    });
                    if (overlapFilter.length > 0) {
                        finishedFabricWidth = overlapFilter[0].FinishedFabricWidth;
                    }

                }

                noOfWidth = parseFloat((finishedFabricWidth / fabricWidth).toFixed(2));
                _noOfWidth.val(noOfWidth);
            }

        }
        if ($("#hdOrderDetail").val() !== '') {
            orderDetails = JSON.parse($("#hdOrderDetail").val());
        }
        loadGrid();
    });

</script>
@if (ViewBag.DownloadFileUrl != null)
{
    <script>
        setTimeout(function () { window.open('@ViewBag.DownloadFileUrl', '_self'); },500);
    </script>
}




